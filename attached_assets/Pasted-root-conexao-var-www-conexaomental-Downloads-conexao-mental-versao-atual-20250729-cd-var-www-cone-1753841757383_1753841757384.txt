root@conexao:/var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729# cd /var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729
root@conexao:/var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729# pm2 delete all
[PM2] Applying action deleteProcessId on app [all](ids: [ 0 ])
[PM2] [conexaomental](0) ✓
┌────┬───────────┬─────────────┬─────────┬─────────┬──────────┬────────┬──────┬───────────┬──────────┬──────────┬──────────┬──────────┐
│ id │ name      │ namespace   │ version │ mode    │ pid      │ uptime │ ↺    │ status    │ cpu      │ mem      │ user     │ watching │
└────┴───────────┴─────────────┴─────────┴─────────┴──────────┴────────┴──────┴───────────┴──────────┴──────────┴──────────┴──────────┘
root@conexao:/var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729# npm install

up to date, audited 550 packages in 5s

70 packages are looking for funding
  run `npm fund` for details

10 vulnerabilities (3 low, 7 moderate)

To address issues that do not require attention, run:
  npm audit fix

To address all issues (including breaking changes), run:
  npm audit fix --force

Run `npm audit` for details.
root@conexao:/var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729# DATABASE_URL="postgresql://cloud_admin@localhost:5432/conexaomental" npm run build

> rest-express@1.0.0 build
> vite build && esbuild server/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist

vite v5.4.15 building for production...
transforming (1) index.htmlBrowserslist: browsers data (caniuse-lite) is 9 months old. Please run:
  npx update-browserslist-db@latest
  Why you should do it regularly: https://github.com/browserslist/update-db#readme
✓ 2633 modules transformed.
[plugin:vite:reporter] [plugin vite:reporter] 
(!) /var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729/client/src/components/sections/OnlineTherapySection.tsx is dynamically imported by /var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729/client/src/pages/Index.tsx but also statically imported by /var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729/client/src/pages/Index.tsx, dynamic import will not move module into another chunk.

[plugin:vite:reporter] [plugin vite:reporter] 
(!) /var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729/client/src/components/sections/SearchSection.tsx is dynamically imported by /var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729/client/src/pages/Index.tsx but also statically imported by /var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729/client/src/pages/Index.tsx, dynamic import will not move module into another chunk.

[plugin:vite:reporter] [plugin vite:reporter] 
(!) /var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729/client/src/components/sections/ProfessionalsSection.tsx is dynamically imported by /var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729/client/src/pages/Index.tsx but also statically imported by /var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729/client/src/pages/Index.tsx, dynamic import will not move module into another chunk.

../dist/public/index.html                                                 0.69 kB │ gzip:   0.40 kB
../dist/public/assets/Header de login (3)_1752464376695-qEK9OtF0.png  2,911.42 kB
../dist/public/assets/index-DPZaXoqA.css                                112.59 kB │ gzip:  17.34 kB
../dist/public/assets/index-tZJhqzCc.js                               1,006.77 kB │ gzip: 267.27 kB

(!) Some chunks are larger than 500 kB after minification. Consider:
- Using dynamic import() to code-split the application
- Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
- Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.
✓ built in 20.05s

  dist/index.js  100.9kb

⚡ Done in 63ms
root@conexao:/var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729# DATABASE_URL="postgresql://cloud_admin@localhost:5432/conexaomental" pm2 start npm --name "conexaomental" -- start
[PM2] Starting /usr/bin/npm in fork_mode (1 instance)
[PM2] Done.
┌────┬──────────────────┬─────────────┬─────────┬─────────┬──────────┬────────┬──────┬───────────┬──────────┬──────────┬──────────┬──────────┐
│ id │ name             │ namespace   │ version │ mode    │ pid      │ uptime │ ↺    │ status    │ cpu      │ mem      │ user     │ watching │
├────┼──────────────────┼─────────────┼─────────┼─────────┼──────────┼────────┼──────┼───────────┼──────────┼──────────┼──────────┼──────────┤
│ 0  │ conexaomental    │ default     │ N/A     │ fork    │ 4082425  │ 0s     │ 0    │ online    │ 0%       │ 22.1mb   │ root     │ disabled │
└────┴──────────────────┴─────────────┴─────────┴─────────┴──────────┴────────┴──────┴───────────┴──────────┴──────────┴──────────┴──────────┘
root@conexao:/var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729# sleep 15
root@conexao:/var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729# curl -s http://localhost:5000 | head -10
root@conexao:/var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729# curl -s http://localhost:5000 | grep -i "planos\|faq"
root@conexao:/var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729# ^C
root@conexao:/var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729# pm2 logs conexaomental --lines 20
[TAILING] Tailing last 20 lines for [conexaomental] process (change the value with --lines option)
/root/.pm2/logs/conexaomental-error.log last 20 lines:
0|conexaom |     at require (node:internal/modules/helpers:182:18)
0|conexaom |     at Object.<anonymous> (/usr/lib/node_modules/npm/lib/cli/validate-engines.js:8:49)
0|conexaom |     at Module._compile (node:internal/modules/cjs/loader:1529:14)
0|conexaom |     at Module._extensions..js (node:internal/modules/cjs/loader:1613:10)
0|conexaom |     at Module.load (node:internal/modules/cjs/loader:1275:32)
0|conexaom |     at Module._load (node:internal/modules/cjs/loader:1096:12)
0|conexaom |     at Module.require (node:internal/modules/cjs/loader:1298:19)
0|conexaom |     at Hook._require.Module.require (/usr/lib/node_modules/pm2/node_modules/require-in-the-middle/index.js:101:39) {
0|conexaom |   code: 'MODULE_NOT_FOUND',
0|conexaom |   requireStack: [
0|conexaom |     '/usr/lib/node_modules/npm/lib/cli/validate-engines.js',
0|conexaom |     '/usr/lib/node_modules/npm/lib/cli.js',
0|conexaom |     '/usr/lib/node_modules/npm/bin/npm-cli.js'
0|conexaom |   ]
0|conexaom | }
0|conexaom | ❌ Failed to connect to database after 3 attempts
0|conexaom | Warning: connect.session() MemoryStore is not
0|conexaom | designed for a production environment, as it will leak
0|conexaom | memory, and will not scale past a single process.
0|conexaom | ❌ Failed to connect to database after 3 attempts

/root/.pm2/logs/conexaomental-out.log last 20 lines:
0|conexaom | Shutting down gracefully...
0|conexaom | 
0|conexaom | > rest-express@1.0.0 start
0|conexaom | > NODE_ENV=production node dist/index.js
0|conexaom | 
0|conexaom | ✅ API externa configurada em /api/v1
0|conexaom | 📚 Documentação: GET /api/v1/status
0|conexaom | 🔑 Autenticação: Bearer token nas rotas protegidas
0|conexaom | ✅ Admin Integration routes configuradas
0|conexaom | 🔌 API externa disponível em /api/v1
0|conexaom | ⚙️ Admin integrações disponível em /api/admin
0|conexaom | 11:08:43 PM [express] serving on port 5000
0|conexaom | ❌ Database connection attempt 1 failed: Hostname/IP does not match certificate's altnames: Host: localhost. is not in the cert's altnames: DNS:conexaomental.online, DNS:www.conexaomental.online
0|conexaom | 🔄 Retrying in 1000ms...
0|conexaom | ❌ Database connection attempt 2 failed: Hostname/IP does not match certificate's altnames: Host: localhost. is not in the cert's altnames: DNS:conexaomental.online, DNS:www.conexaomental.online
0|conexaom | 🔄 Retrying in 2000ms...
0|conexaom | ❌ Database connection attempt 3 failed: Hostname/IP does not match certificate's altnames: Host: localhost. is not in the cert's altnames: DNS:conexaomental.online, DNS:www.conexaomental.online
0|conexaom | 11:09:51 PM [express] GET /api/v1/validate/code 200 in 37ms
0|conexaom | 11:10:14 PM [express] GET /api/v1/validate/code 200 in 31ms
0|conexaom | 11:11:26 PM [express] GET /api/v1/validate/code 200 in 11ms

0|conexaomental  | 11:12:38 PM [express] GET /api/v1/validate/code 200 in 6ms
0|conexaomental  | 11:12:50 PM [express] GET /api/vendor/phpunit/phpunit/src/Util/PHP/eval-stdin.php 200 in 14ms
0|conexaomental  | 11:13:01 PM [express] GET /api/v1/validate/code 200 in 6ms

^C
root@conexao:/var/www/conexaomental/Downloads/conexao-mental-versao-atual-20250729# 